Module PerevodSthisleniya
    Sub Main()
        Dim x, x0, y, d, i, f, k, k0, c, c0, n, s, s0, g, m()
        c = 0 'система счисления на основании которой делается вывод перевод в 10 систему или из 10 системы'
        s = 0 'целое число в веденной системе счисления для перевода в 10 систему счисления'
        k = 0 'система счисления в которую будет переведено число из 10 системы счисления'
        x = 0 'переведенное из десятичной системы счисления число'
        y = 0 'результат перевода числа в другую систему счисления из десятичной'
        Do
            c0 = c
            c = c & InputBox(vbCr & "Целое число системы счисления для перевода из нее числа в десятичное или перевода из десятичного для этого введите 10: " & c, "Ввод цифры из диапазона [2; 10]") ' окно ввода
            If c <> 0 Then c = c : Exit Do ' здесь ввод достаточно осуществить разово
            If Not Right(c, 1) Like "[2-10]" Then c = c0 : Exit Do ' ввод окончен: цифра > 10 или < 2
            If c = c0 Then Exit Do ' ввод окончен ничего не ввели или нажали на Cancel
        Loop
        n = Fix(c) ' защита

        If n < 10 Then ' если берется число не в 10 системе счисления, то оно переводится в нее
            Do
                s0 = s
                s = s & InputBox(vbCr & "Целое число в веденной перед этим системе счисления: " & s, "Ввод очередной цифры из диапазона [0; 9]")
                If Not Right(s, 1) Like "[0-9]" Then s = s0 : Exit Do
                If s = s0 Then Exit Do
            Loop
            g = Fix(s)

            Dim Dvo As String, rezult As Single
            Dvo = g
            For i = 1 To Len(Dvo) ' умножение каждого отдельного символа числа на основание своей системы счисления для перевода в 10 систему
                rezult = rezult + Mid(Dvo, i, 1) * (n ^ (Len(Dvo) - i)) ' происходит своего рода сложение в столбик после умножения в столбик строки многочлена каждого отдельного символа числа
            Next i
            MsgBox("Не десятичное число '" & g & "' переведенное из " & n & "-ичной системы в десятичную: " & rezult & ".")

        Else
            Do
                k0 = k
                k = k & InputBox(vbCr & "Целое число системы счисления для перевода в нее числа: " & k, "Ввод цифры из диапазона [2; 9]")
                If k <> 0 Then k = k : Exit Do
                If Not Right(k, 1) Like "[2-9]" Then k = k0 : Exit Do
                If k = k0 Then Exit Do
            Loop
            f = Fix(k)
            ReDim m(f)
            For i = 0 To f - 1
                m(i) = Hex(i) 'набор всех цифр в массив для перевода в десятичную систему из различных f-еричных систем счисления'
            Next
            Do
                x0 = x
                x = x & InputBox(vbCr & "Целое число в десятичной системе: " & x, "Ввод очередной цифры из диапазона [0; 9]")
                If Not Right(x, 1) Like "[0-9]" Then x = x0 : Exit Do
                If x = x0 Then Exit Do
            Loop
            d = Fix(x) 'десятичный аналог введённого числа
            Do
                y = m(d Mod f) & y 'слева приписывает к изначально пустой строке искомую цифру
                d = d \ f 'десятичный аналог введённого x делим на новое основание нацело пока есть что делить
            Loop Until d = 0
            MsgBox("Десятичное число '" & x & "' в " & f & "-ичной системе: " & y & ".")
        End If
    End Sub
End Module